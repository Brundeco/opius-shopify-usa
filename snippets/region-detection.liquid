<div
  id="geo-message"
  class="fixed z-[1000] wrap hidden flex-col justify-center items-center bg-black bg-opacity-70 w-screen h-screen pointer-events-none"
>
  <div class=" p-6 lg:p-14 flex flex-col gap-4 bg-OpiusRubedoAccent pointer-events-auto">
    <p class=" mb-4 font-medium max-w-xs text-center leading-5">
      You are browsing from within EU zone, and will be redirected to the EU webshop any moment...
    </p>
    <button
      id="redirect-btn"
      class=" bg-opiusDeepGreen text-white px-5 py-4 font-medium text-sm transition-all duration-500"
    >
      Redirect me now
    </button>
    {% comment %} <p class=" text-xs font-medium mt-5 text-center">Redirect will happen automatically any moment</p> {% endcomment %}
    {% comment %}
      <button
        class=" border-opiusDeepGreen border px-5 py-4 text-xs hover:bg-opiusDeepGreen hover:text-white transition-all duration-500"
      >
        Stay on <span class=" font-medium">USA</span> store
      </button>
    {% endcomment %}
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', async () => {
    try {
      const res = await fetch('https://ipapi.co/json/', { cache: 'no-store' });
      const data = await res.json();
      const code = String(data?.country_code || '').toUpperCase();

      const EU_EEA = new Set([
        'AT',
        'BE',
        'BG',
        'CY',
        'CZ',
        'DE',
        'DK',
        'EE',
        'ES',
        'FI',
        'FR',
        'GR',
        'HR',
        'HU',
        'IE',
        'IT',
        'LT',
        'LU',
        'LV',
        'MT',
        'NL',
        'PL',
        'PT',
        'RO',
        'SE',
        'SI',
        'SK',
        'NO',
        'IS',
        'LI',
        'CH',
      ]);

      if (!code) return;

      if (EU_EEA.has(code)) {
        const geo = document.getElementById('geo-message');
        geo.style.display = 'flex';
        setTimeout(() => {
          window.location.href = 'https://opius-distillery.com';
        }, 5000);
        document.getElementById('redirect-btn').onclick = () => {
          window.location.href = 'https://opius-distillery.com';
        };
      }
    } catch (e) {
      console.error('Geo error:', e);
    }
  });
</script>
